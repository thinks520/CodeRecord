# 宏、脚本类恶意代码专题

## 1、为什么是脚本

　　脚本病毒是主要采用脚本语言设计的计算机病毒，早期的脚本病毒基础语言以VBA、BAT为基础编写。通过近几年研究机构发布的样本分析报告比对，发现利用脚本语言结合传统病毒手法层出不穷，攻击者利用脚本语言体积小传播轻便的特点，受害者点击运行恶意脚本代码后，该恶意代码会下载功能更加完善的后门木马。

　　脚本语言的诞生是MicroSoft为了有利于开发人员扩展Windows功能而研发。与传统编译型语言不同，利用Windows自带的组件就可以运行，不具有面向对象的程序概念和方法，直接提供了面向对象的程序设计方法，具有易用、易学的特点。

　　相对于传播体积过大、带有明显恶意代码特征的可执行文件，使用体积小、变化多的脚本语言可以更好地诱导受害者点击恶意代码，起到下载辅助、藏匿自身的作用。
　　
　　所以恶意脚本与传统病毒相结合后可以更容易隐蔽自身。


## 2、传播方式

脚本病毒传播的共同特点：

- 传播范围 广：HTML文档、Email附件

- 变种多：VBS病毒解释执行，可读性非常强

恶意代码通过以下几种方式传播：

系统漏洞：通过操作系统的溢出漏洞进行传播，如影子经纪人泄漏的永恒之蓝、浏览器溢出、Flash溢出漏洞。

网站攻击：通过互联网中网站组件或是本身WEB层面的安全问题进行攻击。如Weblogic、Struts2、Jboss、破壳漏洞。

邮件附件：通过诱导性邮件方式，引诱受害者打开邮件附件或是钓鱼形式的网址。如：通过发送利用Office漏洞执行恶意代码的邮件、发送存有利用溢出漏洞的钓鱼网址

软件供应链：伪装广告软件、传播带有后门的软件如XShell、XCodeGhost事件、文件感染行为。


## 3、恶意行为

挖矿专用、勒索者、窃密远控、后门权限维持。

## 4、脚本代码编程基础

在近期的反病毒工作中捕获到的恶意样本类型：

- 1、Excel Macor(宏)
- 2、PowerShell
- 3、JavaScript
- 4、Lua、AutoIt等脚本语言(广告软件) 

所以我对几类病毒的语言基础和自启动手法做了一个整理并生成包含有相关的代码附件，归类关系如下：


|类型说明  | 目录|
|--------------|--------------|
|Office Macro基础  | 00-Office Macor |
|PowerShell基础  | 01-PowerShell基础 |
|Windows自带EXE下载与自启动  | 02-Windows启动 |
|恶意脚本利用程序框架  | 03-利用框架收集 |

